(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51560,e=>{"use strict";var s=e.i(43476),t=e.i(71645),l=e.i(22016);e.i(36180);var n=e.i(98925);e.i(51718);var o=e.i(18357),r=e.i(59141);function i({success:e}){return e?(0,s.jsx)("svg",{viewBox:"0 0 24 24",className:"h-6 w-6 text-emerald-600",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M5 13l4 4L19 7",strokeLinecap:"round",strokeLinejoin:"round"})}):(0,s.jsx)("svg",{viewBox:"0 0 24 24",className:"h-6 w-6 text-rose-600",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,s.jsx)("path",{d:"M6 6l12 12M6 18L18 6",strokeLinecap:"round",strokeLinejoin:"round"})})}function a(){let[e,a]=(0,t.useState)(null),[d,c]=(0,t.useState)(null),[u,x]=(0,t.useState)(0),[m,g]=(0,t.useState)({}),[h,b]=(0,t.useState)(null),[p,f]=(0,t.useState)(!1),[y,k]=(0,t.useState)({food:"",calories:""}),[j,w]=(0,t.useState)(""),[v,N]=(0,t.useState)(""),[C,S]=(0,t.useState)(""),[T,F]=(0,t.useState)(null),D=(0,t.useMemo)(()=>new Date().toISOString().slice(0,10),[]),L=(0,t.useCallback)(async e=>{if(!r.db)return;let s=(0,n.query)((0,n.collection)(r.db,"calories"),(0,n.where)("userId","==",e),(0,n.where)("date","==",D));x((await (0,n.getDocs)(s)).docs.reduce((e,s)=>e+(Number(s.data().calories)||0),0))},[D]),A=(0,t.useCallback)(async e=>{if(!r.db)return;let s=(await (0,n.getDoc)((0,n.doc)(r.db,"dailyLogs",`${e}_${D}`))).data()??{};g({weight:s.weight,skinCare:s.skinCare,shower:s.shower,supplement:s.supplement,sleepTime:s.sleepTime,exerciseType:s.exerciseType}),s.weight&&w(String(s.weight)),s.sleepTime&&N(String(s.sleepTime)),s.exerciseType&&S(String(s.exerciseType))},[D]);(0,t.useEffect)(()=>{if(!r.auth||!r.db||!r.isFirebaseConfigured)return;let e=(0,o.onAuthStateChanged)(r.auth,async e=>{if(!e){a(null),c(null),g({}),x(0);return}a(e.uid),c(e.displayName??null),await Promise.all([A(e.uid),L(e.uid)])});return()=>e()},[D,L,A]);let $=()=>!!r.auth&&!!r.db&&!!e||(F("Connecte-toi pour enregistrer tes donnees."),!1),E=async(s,t)=>{if($()&&r.db&&e){f(!0),F(null);try{await (0,n.setDoc)((0,n.doc)(r.db,"dailyLogs",`${e}_${D}`),{userId:e,date:D,[s]:t},{merge:!0}),await A(e)}catch(e){console.error(e),F("Echec de l'enregistrement.")}finally{f(!1)}}},B=async()=>{if($()&&r.db&&e&&y.food.trim()&&y.calories.trim()){f(!0),F(null);try{await (0,n.addDoc)((0,n.collection)(r.db,"calories"),{userId:e,userName:d??"",date:D,food:y.food.trim(),calories:Number(y.calories),createdAt:new Date().toISOString()}),k({food:"",calories:""}),await L(e),b(null)}catch(e){console.error(e),F("Echec de l'enregistrement des calories.")}finally{f(!1)}}},M=[{key:"calories",title:"Calorie tracking",badge:u>0?`${u} kcal`:null,ok:u>0,onClick:()=>b({type:"calories"})},{key:"weight",title:"Weight",badge:m.weight?`${m.weight} kg`:null,ok:!!m.weight,onClick:()=>b({type:"weight"})},{key:"exercise",title:"Exercise",badge:m.exerciseType??null,ok:!!m.exerciseType,onClick:()=>b({type:"exercise"})},{key:"skinCare",title:"Skin care",badge:"done"===m.skinCare?"done":null,ok:"done"===m.skinCare,onClick:()=>b({type:"skinCare"})},{key:"shower",title:"Shower",badge:"done"===m.shower?"done":null,ok:"done"===m.shower,onClick:()=>b({type:"shower"})},{key:"sleep",title:"Sleep time",badge:m.sleepTime??null,ok:!!m.sleepTime,onClick:()=>b({type:"sleep"})},{key:"supplement",title:"Supplement",badge:"done"===m.supplement?"done":null,ok:"done"===m.supplement,onClick:()=>b({type:"supplement"})}];return(0,s.jsxs)("div",{className:"space-y-4 pb-16",children:[!r.isFirebaseConfigured&&(0,s.jsx)("div",{className:"rounded-2xl bg-white p-4 shadow-sm ring-1 ring-amber-200",children:(0,s.jsx)("p",{className:"text-sm font-semibold text-amber-700",children:"Configure Firebase pour activer les sauvegardes."})}),T&&(0,s.jsx)("div",{className:"rounded-2xl bg-rose-50 p-4 text-sm font-semibold text-rose-700 ring-1 ring-rose-100",children:T}),(0,s.jsxs)("section",{className:"rounded-2xl bg-white p-5 shadow-sm ring-1 ring-slate-200/70",children:[(0,s.jsx)("h1",{className:"text-lg font-semibold text-slate-900",children:"Daily info"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"3 items per row. Touchez pour mettre a jour."}),(0,s.jsx)("div",{className:"mt-4 grid grid-cols-2 gap-3 sm:grid-cols-3",children:M.map(e=>{let t;return(0,s.jsxs)("button",{onClick:e.onClick,className:"flex h-24 flex-col items-center justify-center gap-2 rounded-xl border border-slate-200 bg-slate-50 px-3 text-center text-sm font-semibold text-slate-800 shadow-sm transition hover:border-sky-200 hover:bg-slate-100",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(t=e.ok,(0,s.jsx)(i,{success:t})),(0,s.jsx)("span",{children:e.title})]}),(0,s.jsx)("p",{className:"text-xs font-medium text-slate-600",children:e.badge??"No entry"})]},e.key)})})]}),h?(0,s.jsx)("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/30 px-4",children:(0,s.jsxs)("div",{className:"w-full max-w-sm rounded-2xl bg-white p-5 shadow-xl ring-1 ring-slate-200",children:["calories"===h.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Add food"}),(0,s.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-slate-800",children:["Food name",(0,s.jsx)("input",{value:y.food,onChange:e=>k(s=>({...s,food:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:border-sky-500 focus:ring-2 focus:ring-sky-100"})]}),(0,s.jsxs)("label",{className:"block text-sm font-medium text-slate-800",children:["Calories",(0,s.jsx)("input",{type:"number",value:y.calories,onChange:e=>k(s=>({...s,calories:e.target.value})),className:"mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:border-sky-500 focus:ring-2 focus:ring-sky-100"})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,s.jsx)("button",{onClick:B,disabled:p,className:"flex-1 rounded-lg bg-sky-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-sky-700 disabled:cursor-not-allowed disabled:bg-sky-300",children:"Save"}),(0,s.jsx)("button",{onClick:()=>b(null),className:"flex-1 rounded-lg border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 transition hover:bg-slate-50",children:"Cancel"})]})]})]}),"weight"===h.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Add weight"}),(0,s.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,s.jsx)("input",{type:"number",value:j,onChange:e=>w(e.target.value),placeholder:"Kg",className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:border-sky-500 focus:ring-2 focus:ring-sky-100"}),(0,s.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,s.jsx)("button",{onClick:()=>{E("weight",Number(j)),b(null)},disabled:p,className:"flex-1 rounded-lg bg-sky-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-sky-700 disabled:cursor-not-allowed disabled:bg-sky-300",children:"Save"}),(0,s.jsx)("button",{onClick:()=>b(null),className:"flex-1 rounded-lg border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 transition hover:bg-slate-50",children:"Cancel"})]})]})]}),"skinCare"===h.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Skin care"}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[(0,s.jsx)("button",{onClick:()=>{E("skinCare","done"),b(null)},className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700",children:"Done"}),(0,s.jsx)("button",{onClick:()=>{E("skinCare","not done"),b(null)},className:"rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-rose-700",children:"Not done"})]})]}),"shower"===h.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Shower"}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[(0,s.jsx)("button",{onClick:()=>{E("shower","done"),b(null)},className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700",children:"Done"}),(0,s.jsx)("button",{onClick:()=>{E("shower","not done"),b(null)},className:"rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-rose-700",children:"Not done"})]})]}),"supplement"===h.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Supplement"}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[(0,s.jsx)("button",{onClick:()=>{E("supplement","done"),b(null)},className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-emerald-700",children:"Done"}),(0,s.jsx)("button",{onClick:()=>{E("supplement","not done"),b(null)},className:"rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-rose-700",children:"Not done"})]})]}),"exercise"===h.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Exercise"}),(0,s.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-slate-800",children:["Select type",(0,s.jsxs)("select",{value:C,onChange:e=>S(e.target.value),className:"mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:border-sky-500 focus:ring-2 focus:ring-sky-100",children:[(0,s.jsx)("option",{value:"",children:"Choose..."}),(0,s.jsx)("option",{value:"gym",children:"gym"}),(0,s.jsx)("option",{value:"run",children:"run"}),(0,s.jsx)("option",{value:"hike",children:"hike"}),(0,s.jsx)("option",{value:"swim",children:"swim"}),(0,s.jsx)("option",{value:"bike",children:"bike"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,s.jsx)("button",{onClick:()=>{C&&(E("exerciseType",C),b(null))},disabled:p,className:"flex-1 rounded-lg bg-sky-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-sky-700 disabled:cursor-not-allowed disabled:bg-sky-300",children:"Save"}),(0,s.jsx)("button",{onClick:()=>b(null),className:"flex-1 rounded-lg border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 transition hover:bg-slate-50",children:"Cancel"})]})]})]}),"sleep"===h.type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Sleep time"}),(0,s.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,s.jsx)("input",{type:"time",value:v,onChange:e=>N(e.target.value),className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:border-sky-500 focus:ring-2 focus:ring-sky-100"}),(0,s.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,s.jsx)("button",{onClick:()=>{E("sleepTime",v),b(null)},disabled:p,className:"flex-1 rounded-lg bg-sky-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-sky-700 disabled:cursor-not-allowed disabled:bg-sky-300",children:"Save"}),(0,s.jsx)("button",{onClick:()=>b(null),className:"flex-1 rounded-lg border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800 transition hover:bg-slate-50",children:"Cancel"})]})]})]})]})}):null,(0,s.jsx)(l.default,{href:"/",className:"fixed bottom-6 right-6 rounded-full bg-rose-600 px-4 py-2 text-sm font-semibold text-white shadow-lg ring-1 ring-rose-300 transition hover:bg-rose-700",children:"come back"})]})}e.s(["default",()=>a])}]);