(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19172,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(22016);e.i(36180);var l=e.i(98925);e.i(51718);var r=e.i(18357),n=e.i(59141);function i(){let[e,i]=(0,s.useState)(null),[o,d]=(0,s.useState)(""),[u,c]=(0,s.useState)(""),[m,x]=(0,s.useState)(""),[h,p]=(0,s.useState)(!0),[b,f]=(0,s.useState)(null),[g,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{if(!n.auth||!n.db||!n.isFirebaseConfigured)return void p(!1);let e=(0,r.onAuthStateChanged)(n.auth,async e=>{if(!e){i(null),p(!1);return}try{let t=(await (0,l.getDoc)((0,l.doc)(n.db,"users",e.uid))).data(),s=t?.name??e.displayName??"",a=t?.birthdate??"";i({name:s,email:e.email??"",birthdate:a}),d(s),c(a)}catch(e){console.error(e)}finally{p(!1)}});return()=>e()},[]);let y=(0,s.useMemo)(()=>e?.name?e.name.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase():"PV",[e?.name]),N=async t=>{if(t.preventDefault(),n.auth&&n.db&&n.auth.currentUser){f(null),j(null);try{o&&o!==e?.name&&await (0,r.updateProfile)(n.auth.currentUser,{displayName:o}),u!==e?.birthdate&&await (0,l.setDoc)((0,l.doc)(n.db,"users",n.auth.currentUser.uid),{name:o||e?.name||"",birthdate:u,email:n.auth.currentUser.email??""},{merge:!0}),m.trim().length>=6&&await (0,r.updatePassword)(n.auth.currentUser,m),i(e=>e?{...e,name:o||e.name,birthdate:u||e.birthdate}:e),f("Profil mis a jour."),x("")}catch(e){console.error(e),j("Impossible de mettre a jour le profil (re-auth necessaire si la session est ancienne).")}}},w=async()=>{n.auth&&(await (0,r.signOut)(n.auth),i(null))};return n.isFirebaseConfigured?h?(0,t.jsx)("div",{className:"rounded-2xl bg-white p-5 shadow-sm ring-1 ring-slate-200/70",children:(0,t.jsx)("p",{className:"text-sm text-slate-700",children:"Chargement du compte..."})}):e?(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("section",{className:"rounded-2xl bg-white p-5 shadow-sm ring-1 ring-slate-200/70",children:[(0,t.jsx)("h1",{className:"text-lg font-semibold text-slate-900",children:"Account"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"Met a jour tes informations et deconnecte-toi."}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-3 rounded-xl border border-slate-100 px-4 py-3",children:[(0,t.jsx)("span",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-sky-100 text-sky-700 font-semibold",children:y}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.name||"Profil"}),(0,t.jsx)("p",{className:"text-xs text-slate-600",children:e.email})]})]}),(0,t.jsxs)("form",{className:"mt-4 space-y-3",onSubmit:N,children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-slate-800",children:["Name",(0,t.jsx)("input",{type:"text",value:o,onChange:e=>d(e.target.value),className:"mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:border-sky-500 focus:ring-2 focus:ring-sky-100"})]}),(0,t.jsxs)("label",{className:"block text-sm font-medium text-slate-800",children:["Birthdate",(0,t.jsx)("input",{type:"date",value:u,onChange:e=>c(e.target.value),className:"mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:border-sky-500 focus:ring-2 focus:ring-sky-100"})]}),(0,t.jsxs)("label",{className:"block text-sm font-medium text-slate-800",children:["New password",(0,t.jsx)("input",{type:"password",minLength:6,placeholder:"Laisse vide pour ne pas changer",value:m,onChange:e=>x(e.target.value),className:"mt-1 w-full rounded-lg border border-slate-200 px-3 py-2 text-sm outline-none focus:border-sky-500 focus:ring-2 focus:ring-sky-100"})]}),b&&(0,t.jsx)("p",{className:"text-sm font-semibold text-emerald-600",children:b}),g&&(0,t.jsx)("p",{className:"text-sm font-semibold text-rose-600",children:g}),(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsx)("button",{type:"submit",className:"w-full rounded-lg bg-sky-600 px-4 py-2.5 text-sm font-semibold text-white transition hover:bg-sky-700",children:"Mettre a jour"}),(0,t.jsx)("button",{type:"button",onClick:w,className:"w-full rounded-lg border border-slate-200 px-4 py-2.5 text-sm font-semibold text-slate-800 transition hover:bg-slate-50",children:"Sign out"})]})]})]})}):(0,t.jsxs)("div",{className:"rounded-2xl bg-white p-5 shadow-sm ring-1 ring-slate-200/70",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Tu n'es pas connecte."}),(0,t.jsxs)("div",{className:"mt-3 flex gap-3",children:[(0,t.jsx)(a.default,{href:"/signin",className:"rounded-lg bg-sky-600 px-4 py-2 text-sm font-semibold text-white",children:"Sign in"}),(0,t.jsx)(a.default,{href:"/signup",className:"rounded-lg border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-800",children:"Sign up"})]})]}):(0,t.jsx)("div",{className:"rounded-2xl bg-white p-5 shadow-sm ring-1 ring-slate-200/70",children:(0,t.jsx)("p",{className:"text-sm font-semibold text-rose-600",children:"Configure Firebase pour utiliser le compte."})})}e.s(["default",()=>i])}]);